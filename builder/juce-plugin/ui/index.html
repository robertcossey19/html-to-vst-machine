<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>HTMLtoVST</title>
<style>
  :root{--bg:#0b0e14;--panel:#121826;--line:rgba(255,255,255,.12);--txt:#e9eefb;--mut:#a9b5d1;--acc:#5aa8ff;}
  html,body{height:100%;margin:0;background:linear-gradient(180deg,#080b12,#0b0e14 60%);color:var(--txt);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;}
  .wrap{height:100%;display:flex;align-items:center;justify-content:center;padding:18px;}
  .card{width:min(760px,100%);background:rgba(18,24,38,.92);border:1px solid var(--line);border-radius:18px;box-shadow:0 12px 40px rgba(0,0,0,.45);padding:18px;}
  .top{display:flex;align-items:flex-end;justify-content:space-between;gap:12px;margin-bottom:14px;}
  .brand{font-weight:800;letter-spacing:.08em}
  .sub{font-size:12px;color:var(--mut)}
  .row{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
  .mod{background:rgba(0,0,0,.22);border:1px solid var(--line);border-radius:16px;padding:14px}
  .lbl{display:flex;justify-content:space-between;font-size:12px;color:var(--mut);margin-bottom:8px}
  input[type=range]{width:100%;}
  .val{font-variant-numeric:tabular-nums;color:var(--txt)}
  .hint{margin-top:12px;font-size:12px;color:var(--mut)}
  .pill{display:inline-block;padding:3px 8px;border:1px solid var(--line);border-radius:999px;margin-left:6px;color:var(--mut)}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="top">
      <div>
        <div class="brand">HTMLtoVST</div>
        <div class="sub">Web UI (wired) â€” inGain / drive / outGain</div>
      </div>
      <div class="sub">juce:// bridge <span class="pill">OK</span></div>
    </div>

    <div class="row">
      <div class="mod">
        <div class="lbl"><span>Input</span><span class="val" id="inGainVal">0.00 dB</span></div>
        <input id="inGain" type="range" min="-24" max="24" step="0.1" value="0">
      </div>
      <div class="mod">
        <div class="lbl"><span>Drive</span><span class="val" id="driveVal">0.000</span></div>
        <input id="drive" type="range" min="0" max="1" step="0.001" value="0">
      </div>
      <div class="mod">
        <div class="lbl"><span>Output</span><span class="val" id="outGainVal">0.00 dB</span></div>
        <input id="outGain" type="range" min="-24" max="24" step="0.1" value="0">
      </div>
    </div>

    <div class="hint">If Cubase automation moves a control, the UI will follow.</div>
  </div>
</div>

<script>
(function(){
  function send(cmd, params){
    let q = "";
    if(params){
      q = "?" + Object.keys(params).map(k => encodeURIComponent(k)+"="+encodeURIComponent(params[k])).join("&");
    }
    window.location.href = "juce://" + cmd + q;
  }

  function setText(id, txt){ const el=document.getElementById(id); if(el) el.textContent=txt; }

  function bindRange(id, fmt){
    const el = document.getElementById(id);
    if(!el) return;
    const valEl = document.getElementById(id + "Val");
    function updText(){
      const v = parseFloat(el.value);
      if(valEl) valEl.textContent = fmt(v);
    }
    el.addEventListener("input", () => {
      updText();
      send("setParam", { id, value: el.value });
    });
    updText();
  }

  window.__setParams = function(obj){
    if(!obj) return;
    if(typeof obj.inGain  === "number"){ const el=document.getElementById("inGain");  if(el) el.value  = obj.inGain;  setText("inGainVal",  obj.inGain.toFixed(2)+" dB"); }
    if(typeof obj.drive   === "number"){ const el=document.getElementById("drive");   if(el) el.value   = obj.drive;   setText("driveVal",   obj.drive.toFixed(3)); }
    if(typeof obj.outGain === "number"){ const el=document.getElementById("outGain"); if(el) el.value = obj.outGain; setText("outGainVal", obj.outGain.toFixed(2)+" dB"); }
  };

  window.__setOneParam = function(id, value){
    const el = document.getElementById(id);
    if(!el) return;
    el.value = value;
    if(id==="inGain")  setText("inGainVal",  Number(value).toFixed(2)+" dB");
    if(id==="drive")   setText("driveVal",   Number(value).toFixed(3));
    if(id==="outGain") setText("outGainVal", Number(value).toFixed(2)+" dB");
  };

  bindRange("inGain",  v => v.toFixed(2) + " dB");
  bindRange("drive",   v => v.toFixed(3));
  bindRange("outGain", v => v.toFixed(2) + " dB");

  send("ready");
})();
</script>
</body>
</html>
